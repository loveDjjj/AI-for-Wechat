# 微信AI自动回复助手

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.7+-blue.svg" alt="Python Version">
  <img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License">
  <img src="https://img.shields.io/badge/Platform-Windows-lightgrey.svg" alt="Platform">
</p>

> 🤖 基于阿里云通义千问大模型的智能微信自动回复系统，实现自然流畅的对话体验，解决无法及时回复消息的问题。

## 📑 目录

- [功能特点](#-功能特点)
- [系统架构](#-系统架构)
- [环境要求](#-环境要求)
- [安装步骤](#-安装步骤)
- [配置说明](#-配置说明)
- [使用方法](#-使用方法)
- [示例演示](#-示例演示)
- [常见问题](#-常见问题)
- [更新日志](#-更新日志)
- [许可证](#-许可证)

## ✨ 功能特点

- **实时监听**：通过wxauto库实时监听微信消息，支持群聊和个人对话
- **智能回复**：集成阿里云通义千问大模型，根据上下文生成自然流畅的回复
- **自动触发**：设置时间间隔自动触发AI回复，无需手动操作
- **聊天记录**：自动保存完整聊天记录，方便回溯查看
- **多会话支持**：同时监听多个聊天会话，智能识别活跃对话
- **历史消息加载**：自动加载并保存聊天历史，维持对话连贯性

## 🔍 系统架构

项目由两个核心模块组成：

1. **聊天监听模块 (chat_logger.py)**
   - 基于wxauto库与微信PC客户端交互
   - 实时监听微信消息并记录
   - 管理多会话切换与活跃状态
   - 自动触发AI回复

2. **AI回复模块 (AI.py)**
   - 连接阿里云通义千问API
   - 解析聊天记录并格式化处理
   - 生成智能回复并返回
   - 支持流式响应

## 🛠 环境要求

- Python 3.7+
- Windows操作系统（wxauto库依赖）
- 微信PC客户端
- 阿里云通义千问API账号

## 📦 安装步骤

1. **克隆项目仓库**

```bash
git clone https://github.com/yourusername/wechat-auto-reply.git
cd wechat-auto-reply
```

2. **安装依赖包**

```bash
pip install wxauto openai datetime
```

3. **获取阿里云通义千问API密钥**

前往[阿里云通义千问开放平台](https://dashscope.aliyun.com/)注册并获取API密钥。

## ⚙️ 配置说明

### AI模型配置

打开`AI.py`文件，修改以下配置：

```python
# 设置你的阿里云通义千问API密钥
self.api_key = 'your-api-key-here'

# 如需使用其他AI模型，修改以下行
response = self.client.chat.completions.create(
    model="other-model-name",  # 替换为你想使用的模型
    messages=messages,
    stream=stream
)
```

### 聊天监听配置

修改`chat_logger.py`主函数中的监听目标：

```python
# 添加要监听的聊天
listen_targets = [
    '联系人1',  # 替换为你想监听的微信联系人或群聊名称
    '群聊名称',  # 可添加多个监听目标
]
```

### 自动回复触发配置

在`chat_logger.py`中，修改时间触发阈值：

```python
# 修改自动回复触发时间（秒）
if time_diff.total_seconds() > 60:  # 默认60秒，可根据需要调整
```

## 🚀 使用方法

1. **启动微信客户端**

确保微信PC版已登录并置于前台。

2. **运行聊天监听程序**

```bash
python chat_logger.py
```

3. **查看监听状态**

程序会输出已成功添加的监听聊天，并开始记录消息。

4. **观察自动回复**

当监听的聊天超过设定时间没有新消息时，系统会自动调用AI生成回复。

5. **查看聊天记录**

所有聊天记录将保存在`chat_log.txt`文件中，格式化消息保存在`chat_messages.txt`中。

## 📝 示例演示

### 日志记录示例

```
[2025-05-02 20:06:23] [关键词] 我们三个人点了五个菜哈哈哈哈哈
[2025-05-02 20:06:23] [关键词] 不过都吃完啦
[2025-05-02 20:06:23] [关键词] 这是凉面，碗比我头都大
[2025-05-02 20:06:23] [自己] 好嘞
```

### AI回复示例

```
[2025-05-02 20:07:03] [AI回复]
哈哈，原来是在搞定位啊，怪不得这么麻烦 😊
[2025-05-02 20:07:05] [系统] 已自动发送AI回复: 哈哈，原来是在搞定位啊，怪不得这么麻烦 😊
```

## ❓ 常见问题

### 1. 无法连接微信

**问题**：程序报错"连接微信失败"。
**解决方案**：
- 确保微信PC版已打开且在前台
- 确保微信窗口未被最小化
- 尝试重启微信和程序

### 2. AI回复生成失败

**问题**：程序显示"AI回复生成失败"。
**解决方案**：
- 检查API密钥是否正确
- 确认网络连接稳定
- 查看API调用限制是否已达上限

### 3. 无法找到聊天对象

**问题**：程序无法找到指定的聊天对象。
**解决方案**：
- 确保聊天名称与微信中显示的完全一致
- 尝试先在微信中手动打开该聊天窗口

## 📚 更新日志

### v1.0.0 (2025-05-01)
- 初始版本发布
- 实现基本的微信消息监听功能
- 集成阿里云通义千问API生成回复

## 📄 许可证

本项目采用 [MIT 许可证](LICENSE)。

---

<p align="center">Made with ❤️ by Your Name</p> 